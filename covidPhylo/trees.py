from ete3 import Tree, TreeStyle
import numpy as np

# Load the tree
tree = Tree('(MT121215.1:0.0000707337,((((((((((((((((((((((((MT123292.2:0.0009453752,LC528233.1:0.0004960973):0.0003850779,LC528232.1:0.0005605982):0.0003578511,MT114418.1:0.0000357271):0.0000029131,((MT372481.1:0.0003650362,MT385486.1:0.0000746774):0.0000020411,MT344946.1:0.0000020412):0.0001411324):0.0000020712,(((MT371047.1:0.0002119544,(MT374107.1:0.0000028799,MT374106.1:0.0000028933):0.0002473942):0.0000028551,(MT114415.1:0.0000020412,MT114414.1:0.0000020412):0.0000027859):0.0000013168,((MT374104.1:0.0000023985,MT370518.1:0.0000020412):0.0000025791,(MT374102.1:0.0000020412,(MT370516.1:0.0000020412,MT374103.1:0.0000367043):0.0000020411):0.0000025974):0.0001056133):0.0001052478):0.0000021751,LC542809.1:0.0001057052):0.0000495785,(((MT039890.1:0.0002824611,MT007544.1:0.0000702036):0.0000027171,(MT186683.1:0.0000719881,(MT093571.1:0.0002180195,MN994468.1:0.0000364249):0.0000029722):0.0000020411):0.0000025457,((((MT371050.1:0.0000351885,MT325634.1:0.0000020892):0.0000350350,(MT350282.1:0.0000705077,(MT374105.1:0.0000020412,((MT246454.1:0.0000731198,MT258377.1:0.0000369705):0.0000020411,MT326117.1:0.0000020412):0.0000020411):0.0000029638):0.0000020096):0.0000353403,MT163716.1:0.0003604576):0.0000333670,MT281577.1:0.0001412840):0.0000349650):0.0000344566):0.0000020667,MT019530.1:0.0002161357):0.0000022000,(MT114413.1:0.0000020607,MT114412.1:0.0000020731):0.0000357176):0.0000024379,(MT192772.1:0.0000029212,MT192773.1:0.0000349972):0.0000349971):0.0000022230,MT385431.1:0.0000364045):0.0000020411,MN908947.3:0.0000020412):0.0000020411,NC_045512.2:0.0000020412):0.0000020411,MN996528.1:0.0000020412):0.0000020411,MT019529.1:0.0001058416):0.0000020411,MT019531.1:0.0000352743):0.0000028883,MT019533.1:0.0000364338):0.0000020411,MT019532.1:0.0000020412):0.0000020411,MT396241.1:0.0000351460):0.0000020499,(MT334529.1:0.0000352933,(MT385436.1:0.0000731456,MT263429.1:0.0001489512):0.0000020183):0.0000702136):0.0000020636,MT385425.1:0.0001069305):0.0000025188,MT385430.1:0.0000357722):0.0000028192,(LC529905.1:0.0000350648,MT123290.1:0.0001863349):0.0000724830):0.0000020841,(((((((((((MT326187.1:0.0000710279,(((MT263381.1:0.0000020412,(((MT252748.1:0.0000355448,((((((MT263421.1:0.0002080372,((MT263382.1:0.0000491240,MT252805.1:0.0001169083):0.0000929980,(MT293208.1:0.0000020412,MT259236.1:0.0000020412):0.0000709840):0.0000020997):0.0000010129,(MT259269.1:0.0001452776,MT293159.1:0.0000736081):0.0000359332):0.0000016116,MT263399.1:0.0000366915):0.0000373959,MT246477.1:0.0000368526):0.0000029818,MT345840.1:0.0000725436):0.0000013187,MT246474.1:0.0000742729):0.0000020037):0.0000025809,MT252677.1:0.0000020412):0.0000014392,MT246466.1:0.0000020412):0.0000021269):0.0000043234,MT326052.1:0.0000738118):0.0000025622,MT252783.1:0.0004997540):0.0000971128):0.0000012286,(((((((((MT263396.1:0.0000708171,(MT163718.1:0.0001296836,MT246478.1:0.0000735284):0.0000129382):0.0000184420,MT385434.1:0.0000728788):0.0000014912,MT358742.1:0.0001107877):0.0000012357,MT259254.1:0.0000020412):0.0000028217,(MT334533.1:0.0000029489,MT334534.1:0.0000020931):0.0000689933):0.0000024049,MT334536.1:0.0000020412):0.0000012244,MT385424.1:0.0000020412):0.0000029183,MT358675.1:0.0000020412):0.0000021191,MT385421.1:0.0000020412):0.0000014725):0.0000021187,MT263395.1:0.0001062192):0.0000021970,MT334535.1:0.0000020412):0.0000024662,(MT322409.1:0.0000020714,MT163717.1:0.0000021423):0.0001060570):0.0000021894,MT252797.1:0.0000356441):0.0000160588,MT251978.1:0.0000348334):0.0000029007,MT334523.1:0.0000020412):0.0000023710,MT385419.1:0.0000020412):0.0000019914,(((((((((((((((((MT252702.1:0.0001034636,MT252793.1:0.0001461931):0.0000022499,(MT246459.1:0.0001820386,(MT252707.1:0.0001110743,MT263398.1:0.0001380649):0.0000011853):0.0000829053):0.0000853027,MT295464.1:0.0000364923):0.0000040041,MT322397.1:0.0000362611):0.0000027175,MT345833.1:0.0000020412):0.0000011809,MT385432.1:0.0000728722):0.0000010695,MT385429.1:0.0000020412):0.0000054876,MT339039.1:0.0000359518):0.0000023952,MT252780.1:0.0000358048):0.0000020411,MT344954.1:0.0001095504):0.0000020411,MT344944.1:0.0000020412):0.0000020411,MT325609.1:0.0000020412):0.0000020411,MT325613.1:0.0000020412):0.0000020411,MT344949.1:0.0000364468):0.0000020411,MT163719.1:0.0000350810):0.0000026338,(MT246462.1:0.0000351012,MT246452.1:0.0000020635):0.0000353364):0.0000020411,MT334538.1:0.0001054436):0.0000020573):0.0001026688,(LC542976.1:0.0000701847,(((((MT135044.1:0.0000000000,MT135041.1:0.0000000000):0.0000020412,MT135042.1:0.0000020412):0.0000020472,MT135043.1:0.0000345808):0.0000695770,((MT114417.1:0.0000356451,MN975262.1:0.0001071387):0.0000020411,(MT328034.1:0.0002557653,MT325628.1:0.0001829155):0.0000020412):0.0000020411):0.0000024594,((MT049951.1:0.0001022991,MT226610.1:0.0009387944):0.0000042015,((MT295465.1:0.0000728320,(MT324684.1:0.0000020412,((MT344945.1:0.0000000000,MT325623.1:0.0000000000):0.0000020412,(((MT325625.1:0.0000364311,MT325608.1:0.0000364358):0.0000020411,MT325607.1:0.0000364329):0.0000020411,MT325624.1:0.0000020412):0.0000020411):0.0000020411):0.0000020881):0.0001407013,MT230904.1:0.0000713864):0.0001054801):0.0000020042):0.0000025088):0.0000029172):0.0000683242):0.0000025888,(((((((((((((MT358716.1:0.0001187379,MT358722.1:0.0000367346):0.0000024303,(MT358718.1:0.0001768272,(MT358721.1:0.0000392128,MT345885.1:0.0001445836):0.0000372461):0.0000365284):0.0001577955,MT358695.1:0.0000353715):0.0000021401,MT375446.1:0.0000367263):0.0000020195,(MT263391.1:0.0000343744,((MT358736.1:0.0001069705,MT358744.1:0.0001449217):0.0000345897,(MT358715.1:0.0000710979,(MT375481.1:0.0000356086,(MT259278.1:0.0000020412,(MT252779.1:0.0000356482,MT326092.1:0.0000734684):0.0000020411):0.0000020411):0.0000020411):0.0000020411):0.0000026826):0.0000347305):0.0000336422,MT358705.1:0.0000341038):0.0000026457,MT375453.1:0.0000020412):0.0000024278,MT345882.1:0.0000368731):0.0000015478,(((MT345873.1:0.0001789199,((MT345834.1:0.0002891735,MT345806.1:0.0001104026):0.0000023589,(((((MT251976.1:0.0000020412,(MT326167.1:0.0001447153,MT345805.1:0.0000020412):0.0000020818):0.0000349452,(MT293204.1:0.0000020193,(MT326129.1:0.0000366133,(MT259273.1:0.0000020412,MT326106.1:0.0000924548):0.0000020190):0.0000020320):0.0000021448):0.0000430065,MT246467.1:0.0000358517):0.0000022107,MT326065.1:0.0001090457):0.0000011074,MT326132.1:0.0001493964):0.0000388377):0.0000020570):0.0000011416,(MT358649.1:0.0000901659,MT259251.1:0.0000023569):0.0000832890):0.0000332969,MT263468.1:0.0000733097):0.0000336504):0.0000265684,((MT345869.1:0.0001421825,MT345868.1:0.0000370686):0.0000020012,MT345877.1:0.0001068865):0.0000350806):0.0000336742,((((((MT358734.1:0.0000020412,((MT326190.1:0.0000023437,MT293196.1:0.0000360687):0.0001021968,(MT375432.1:0.0001435262,MT252794.1:0.0000020412):0.0000025135):0.0000025805):0.0000700046,MT263459.1:0.0004235024):0.0000037458,(MT246460.1:0.0000600351,MT375447.1:0.0000715285):0.0000043091):0.0000025472,MT365033.1:0.0000020412):0.0000610574,(MT345819.1:0.0000356054,MT358740.1:0.0001650341):0.0000530786):0.0000054808,(((((((((MT339041.1:0.0000020412,(((((((((((((MT334547.1:0.0001058896,((MT326178.1:0.0000706769,MT385435.1:0.0000731396):0.0000345162,MT345862.1:0.0002924700):0.0000023886):0.0000020012,MT325627.1:0.0000020412):0.0000029942,MT344959.1:0.0000020412):0.0000020411,MT385417.1:0.0000350119):0.0000020411,(MT385414.1:0.0000021008,(MT385426.1:0.0000020412,MT385438.1:0.0000357937):0.0000020124):0.0000344128):0.0000027355,(MT322417.1:0.0000020554,MT322414.1:0.0000712173):0.0000346725):0.0000020411,MT334540.1:0.0001065228):0.0000020813,MT374113.1:0.0000714824):0.0000020411,MT385420.1:0.0000345180):0.0000029049,((MT385422.1:0.0000025193,MT258381.1:0.0000020412):0.0000020060,MT385442.1:0.0000728579):0.0000344420):0.0000020997,(((((((MT350239.1:0.0000463740,MT350249.1:0.0000373845):0.0000943628,MT258382.1:0.0000379510):0.0000024320,MT258383.1:0.0000367874):0.0000020411,MT358702.1:0.0000020412):0.0000020411,MT258380.1:0.0000020412):0.0000020411,MT385437.1:0.0001838623):0.0000020411,MT293213.1:0.0001110171):0.0000020411):0.0000028169,((MT334537.1:0.0000020412,MT334526.1:0.0000025868):0.0000020425,MT325610.1:0.0000020749):0.0000344873):0.0000028247,MT350245.1:0.0000020412):0.0000020586):0.0000020411,MT385415.1:0.0000344076):0.0000029160,((MT334542.1:0.0000020412,((MT322419.1:0.0000353243,(MT322418.1:0.0000020072,MT322400.1:0.0000020412):0.0000020411):0.0000352945,MT350251.1:0.0000029863):0.0000028405):0.0000301473,(MT350253.1:0.0000021128,MT350252.1:0.0000021368):0.0000358833):0.0000051204):0.0000020577,MT385423.1:0.0000020412):0.0000020411,MT374110.1:0.0000020412):0.0000020411,MT322413.1:0.0000028533):0.0000020411,(MT385439.1:0.0000020371,MT385440.1:0.0001103013):0.0000709832):0.0000024372,MT322424.1:0.0000344382):0.0000020478,(((MT334544.1:0.0000351023,MT344960.1:0.0000020412):0.0000020411,(MT358402.1:0.0001086092,(MT358401.1:0.0001091601,MT263406.1:0.0001118986):0.0000349622):0.0000020411):0.0000020280,(MT385416.1:0.0000705281,(((((MT345871.1:0.0000945157,MT375431.1:0.0001478357):0.0000020028,MT345875.1:0.0000020412):0.0000453223,MT385433.1:0.0000020412):0.0000021776,MT258378.1:0.0000020412):0.0000020411,MT385427.1:0.0000020412):0.0000029725):0.0000347584):0.0000345979):0.0000028447):0.0000029978):0.0000334446,((MT246480.1:0.0000020201,((MT374112.1:0.0001064255,(MT322401.1:0.0000020412,(MT374115.1:0.0000020412,(MT322402.1:0.0000367036,(MT375474.1:0.0000368602,MT385441.1:0.0000730707):0.0000020411):0.0000020411):0.0000020411):0.0000020411):0.0000020369,((((MT344953.1:0.0000020412,MT325612.1:0.0000020412):0.0000020411,MT344947.1:0.0000020412):0.0000020411,MT325611.1:0.0000020412):0.0000020411,MT325622.1:0.0000731500):0.0000024753):0.0000028984):0.0000343479,(((MT322405.1:0.0000020764,MT322410.1:0.0000014965):0.0000683427,(MT350240.1:0.0000365092,MT322406.1:0.0000764856):0.0000354586):0.0000029436,(((MT344963.1:0.0000366370,((MT325639.1:0.0000000000,MT325629.1:0.0000000000):0.0000020412,MT325636.1:0.0000020412):0.0000021031):0.0000366409,(MT325640.1:0.0000366001,MT325635.1:0.0000366434):0.0000020323):0.0000020411,((((((MT325638.1:0.0000000000,MT325631.1:0.0000000000):0.0000000000,MT325630.1:0.0000000000):0.0000000000,MT325616.1:0.0000000000):0.0000000000,MT325633.1:0.0000000000):0.0000000000,MT325632.1:0.0000000000):0.0000020412,MT325637.1:0.0000020412):0.0000020536):0.0000020619):0.0000344421):0.0000024547):0.0000345599,(MT252784.1:0.0000020412,((((MT371049.1:0.0000703982,(((MT374111.1:0.0000345909,MT293219.1:0.0000373264):0.0000347352,MT359865.1:0.0000020412):0.0000020663,(MT385428.1:0.0000720058,MT344948.1:0.0000020706):0.0000351707):0.0000342957):0.0000020464,MT324062.1:0.0000703970):0.0000020411,(MT358637.1:0.0001410240,(((MT325626.1:0.0000731412,MT325615.1:0.0000366702):0.0000020411,(MT325618.1:0.0000363520,MT325614.1:0.0000363567):0.0000020411):0.0000020411,(((MT325621.1:0.0000000000,MT325617.1:0.0000000000):0.0000000000,MT325619.1:0.0000000000):0.0000020412,MT325620.1:0.0000020412):0.0000020411):0.0000020411):0.0000020411):0.0000020411,(((MT371048.1:0.0000020412,(MT328035.1:0.0000343142,((MT385418.1:0.0000344221,(MT350254.1:0.0001092322,MT359866.1:0.0000366027):0.0000029577):0.0000344168,((MT374116.1:0.0000349847,MT374108.1:0.0000353834):0.0000020411,(MT374114.1:0.0000352812,(MT374109.1:0.0000715626,MT258379.1:0.0000366149):0.0000020411):0.0000020411):0.0000020411):0.0000020411):0.0000020411):0.0000020411,MT328032.1:0.0000704610):0.0001058352,((MT334541.1:0.0000713208,(MT322423.1:0.0000020412,MT322422.1:0.0000020412):0.0001807872):0.0000340237,(MT334546.1:0.0000020412,MT375459.1:0.0001107549):0.0000020411):0.0000028112):0.0000020411):0.0000020411):0.0000020479):0.0001368169);')

# Set the style
circular_style = TreeStyle()
circular_style.mode = "c"
circular_style.scale = 20

# Render the tree into an image
tree.render("mytree.png", w=2048, units='mm', tree_style=circular_style)

# Part to take the alignments with lowest number of gaps
file = open('complete_gene_align.txt', 'r')

# Read the information
data = file.read()
file.close()
data = data.split('>')[1::]  # The first element is an empty string

# Take the best n models
n_genomes = 300
gaps = list(enumerate([model.count('-') for model in data]))
data = '\n'.join(['>' + data[element[0]] for element in sorted(gaps, key=lambda x: x[1])[0:n_genomes]])

# Write the selected data into another file
file = open('./examples/example2/selected_data.txt', 'w')
file.write(data)
file.close()
